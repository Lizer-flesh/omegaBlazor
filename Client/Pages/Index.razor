@page "/"

@inject HttpClient Http

@using Microsoft.AspNetCore.Components.Web
@inject NavigationManager NavigationManager

@if (for_index)
{
    <PageTitle>Index</PageTitle>


    <h1>Вход</h1>

    <div class="entrance">
        <div class="login">
           <h4>Введите login</h4>
           <input  type="email" @bind="@login"/>
        </div>
        <div class="password">
            <h4>Введите пароль</h4>
            <input type="password" @bind="@password"/>
        </div>
            <h3><button id="EntranceBut" @onclick="click">Войти</button></h3>
            <h4>@message</h4>
    </div>
}
else 
{
    <h4>Вы уже авторизованы</h4>
    <h4>@identUser</h4>
}




@code{



    public static bool for_index = true;
    public static bool for_pages;
    private string message;
    public static int identUser;
    public string login { get; set; }
    public string password { get; set; }
    public string res { get; set; }


 /*   protected Landing.User user = new Landing.User()*/


    async void click()
    {
        using var response = await Http.PostAsJsonAsync("Users",new string[]{login,password});
            Users User = await response.Content.ReadFromJsonAsync<Users>();
        if(User.login != null)
        {
            for_index = false;
            for_pages = true;
            //identUser = user.IdUser;
            NavigationManager.NavigateTo("counter");

        }else
        {
            message = "Неверный логин или пароль";
            NavigationManager.NavigateTo("/");
        }
    }

    
}
